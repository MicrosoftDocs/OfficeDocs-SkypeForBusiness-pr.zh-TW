---
title: 安裝與 Microsoft Teams 的 Moodle 整合
author: MicrosoftHeidi
ms.author: heidip
manager: serdars
ms.topic: article
ms.service: msteams
audience: admin
ms.reviewer: ''
search.appverid: MET150
description: 瞭解如何在 MICROSOFT Teams 的 LMS (中) 和設定 Moodle 開放來源學習管理系統。
keywords: Teams Moodle App 整合外掛程式
localization_priority: Normal
f1.keywords:
- NOCSH
ms.collection:
- M365-collaboration
ms.custom:
- seo-marvel-apr2020
- seo-marvel-mar2020
appliesto:
- Microsoft Teams
ms.openlocfilehash: 3d547d3c811f499faee5727634068a7807566293
ms.sourcegitcommit: a731226d62d8b23fe73bd7bf61654e16367fbd90
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/22/2021
ms.locfileid: "51948709"
---
# <a name="installing-the-moodle-integration-with-microsoft-teams"></a><span data-ttu-id="e2100-104">安裝與 Microsoft Teams 的 Moodle 整合</span><span class="sxs-lookup"><span data-stu-id="e2100-104">Installing the Moodle integration with Microsoft Teams</span></span>

> [!VIDEO https://www.youtube.com/embed/OHlPt22nKoE]

<span data-ttu-id="e2100-105">[Moodle](https://moodle.org/)是 LMS (中最受歡迎的) 系統，現在已與 Microsoft Teams 整合！</span><span class="sxs-lookup"><span data-stu-id="e2100-105">[Moodle](https://moodle.org/), the most popular and open-source Learning Management System (LMS) in the world, is now integrated with Microsoft Teams!</span></span> <span data-ttu-id="e2100-106">此整合可協助授課者和教師圍繞 Moodle 課程共同作業、詢問成績和作業相關問題，以及隨時更新通知 ，就在 Teams 中！</span><span class="sxs-lookup"><span data-stu-id="e2100-106">This integration helps educators and teachers collaborate around Moodle courses, ask questions about their grades and assignments and stay updated with notifications -- right within Teams!</span></span>

<span data-ttu-id="e2100-107">為了協助 IT 系統管理員輕鬆設定此整合，我們已使用下列功能更新開放來源 Moodle 外掛程式：</span><span class="sxs-lookup"><span data-stu-id="e2100-107">To help IT admins easily set this integration up, we have updated our open-source Moodle Plugin with the following capabilities:</span></span>

* <span data-ttu-id="e2100-108">使用 Azure AD 自動註冊 Moodle 伺服器。</span><span class="sxs-lookup"><span data-stu-id="e2100-108">Auto-registration of your Moodle server with Azure AD.</span></span>
* <span data-ttu-id="e2100-109">一鍵將 Moodle 小幫手 Bot 部署到 Azure。</span><span class="sxs-lookup"><span data-stu-id="e2100-109">One-click deployment of your Moodle Assistant bot to Azure.</span></span>
* <span data-ttu-id="e2100-110">針對所有團隊自動提供團隊和自動同步處理團隊註冊，或選取 Moodle 課程。</span><span class="sxs-lookup"><span data-stu-id="e2100-110">Auto-provisioning of teams and auto-synchronization of team enrollments for all or select Moodle courses.</span></span>
* <span data-ttu-id="e2100-111">自動將 Moodle 定位停駐點和 Moodle 小幫手 Bot 自動安裝至每個同步的團隊。</span><span class="sxs-lookup"><span data-stu-id="e2100-111">Auto-installation of the Moodle tab and the Moodle Assistant bot into each synchronized team.</span></span> <span data-ttu-id="e2100-112"> (即將推出) </span><span class="sxs-lookup"><span data-stu-id="e2100-112">(Coming soon)</span></span>
* <span data-ttu-id="e2100-113">一鍵將 Moodle App 發佈至您的私人 Teams App Store。</span><span class="sxs-lookup"><span data-stu-id="e2100-113">One-click publishing of the Moodle app into your private Teams App Store.</span></span> <span data-ttu-id="e2100-114"> (即將推出) </span><span class="sxs-lookup"><span data-stu-id="e2100-114">(Coming soon)</span></span>

<span data-ttu-id="e2100-115">若要深入瞭解此整合提供的功能，請參閱安裝與 Microsoft Teams 的 [Moodle 整合](/microsoftteams/platform/resources/moodleinstructions)。</span><span class="sxs-lookup"><span data-stu-id="e2100-115">To learn more about the functionality this integration provides, see [Installing the Moodle integration with Microsoft Teams](/microsoftteams/platform/resources/moodleinstructions).</span></span>

## <a name="prerequisites"></a><span data-ttu-id="e2100-116">必要條件</span><span class="sxs-lookup"><span data-stu-id="e2100-116">Prerequisites</span></span>

<span data-ttu-id="e2100-117">若要安裝和設定此應用程式，您需要：</span><span class="sxs-lookup"><span data-stu-id="e2100-117">In order to install and configure this application you'll need:</span></span>

1. <span data-ttu-id="e2100-118">Moodle 系統管理員認證</span><span class="sxs-lookup"><span data-stu-id="e2100-118">Moodle administrator credentials</span></span>
2. <span data-ttu-id="e2100-119">Azure AD 系統管理員認證</span><span class="sxs-lookup"><span data-stu-id="e2100-119">Azure AD administrator credentials</span></span>
3. <span data-ttu-id="e2100-120">您可以在中建立新資源的 Azure 訂閱</span><span class="sxs-lookup"><span data-stu-id="e2100-120">An Azure subscription you can create new resources in</span></span>

## <a name="step-1-install-the-moodle-plugin"></a><span data-ttu-id="e2100-121">步驟 1：安裝 Moodle 外掛程式</span><span class="sxs-lookup"><span data-stu-id="e2100-121">Step 1: Install the Moodle Plugin</span></span>

> [!VIDEO https://www.youtube.com/embed/SETEC5nzMgk]

<span data-ttu-id="e2100-122">Microsoft Teams 中的 Moodle 整合是由開放來源 [Moodle 外掛程式集所提供](https://github.com/Microsoft/o365-moodle)。</span><span class="sxs-lookup"><span data-stu-id="e2100-122">The Moodle integration in Microsoft Teams is powered by the open source [Moodle plugin set](https://github.com/Microsoft/o365-moodle).</span></span> <span data-ttu-id="e2100-123">若要在您的 Moodle 伺服器中安裝外掛程式：</span><span class="sxs-lookup"><span data-stu-id="e2100-123">To install the plugin in your Moodle server:</span></span>

1. <span data-ttu-id="e2100-124">首先，下載 [Moodle 外掛程式集，](https://moodle.org/plugins/pluginversions.php?plugin=local_o365) 並將其儲存到您的本地電腦。</span><span class="sxs-lookup"><span data-stu-id="e2100-124">First, download the [Moodle plugin set](https://moodle.org/plugins/pluginversions.php?plugin=local_o365) and save it to your local computer.</span></span> <span data-ttu-id="e2100-125">您必須使用版本 3.5 或更新版本。</span><span class="sxs-lookup"><span data-stu-id="e2100-125">You'll need to use version 3.5 or newer.</span></span>
    * <span data-ttu-id="e2100-126">安裝local_o365外掛程式也會安裝auth_oidc boost_o365Teams外掛程式。 [](https://moodle.org/plugins/auth_oidc) [](https://moodle.org/plugins/pluginversions.php?plugin=theme_boost_o365teams)</span><span class="sxs-lookup"><span data-stu-id="e2100-126">Installing the local_o365 plugin will also install the [auth_oidc](https://moodle.org/plugins/auth_oidc) and [boost_o365Teams](https://moodle.org/plugins/pluginversions.php?plugin=theme_boost_o365teams) plugins.</span></span>
1. <span data-ttu-id="e2100-127">以系統管理員的登錄您的 Moodle 伺服器，然後從左側流覽 **面板** 選取網站管理。</span><span class="sxs-lookup"><span data-stu-id="e2100-127">Sign in to your Moodle server as an administrator, and select **Site administration** from the left navigation panel.</span></span>
1. <span data-ttu-id="e2100-128">選取 [ **外掛程式>** 選項卡，然後按一下 [ **安裝外掛程式**> 。</span><span class="sxs-lookup"><span data-stu-id="e2100-128">Select the **Plugins** tab, and then click **Install plugins**.</span></span>
1. <span data-ttu-id="e2100-129">在 [ **從 ZIP 檔案安裝外掛程式** > 區段下，按一下 [ **選擇檔案>** 按鈕。</span><span class="sxs-lookup"><span data-stu-id="e2100-129">Under the **Install plugin from ZIP file** section click the **Choose a file** button.</span></span>
1. <span data-ttu-id="e2100-130">從左側 **流覽** 選取 [上傳檔案選項，流覽上方下載的檔案，然後按一下 **[上傳此檔案**> 。</span><span class="sxs-lookup"><span data-stu-id="e2100-130">Select the **Upload a file** option from the left navigation, browse for the file you downloaded above and click **Upload this file**.</span></span>
1. <span data-ttu-id="e2100-131">再次 **從左側流覽面板** 選取網站管理選項，以返回您的系統管理儀表板。</span><span class="sxs-lookup"><span data-stu-id="e2100-131">Select the **Site administration** option from the left navigation panel again to return to your admin dashboard.</span></span> <span data-ttu-id="e2100-132">向下卷起至 **[本地外掛程式** ，然後按一下 **Microsoft Office 365 整合連結** 。</span><span class="sxs-lookup"><span data-stu-id="e2100-132">Scroll down to the **Local plugins** and click the **Microsoft Office 365 Integration** link.</span></span> <span data-ttu-id="e2100-133">在個別的瀏覽器選項卡中保持此組式頁面開啟，因為您將在整個程式的其餘部分使用。</span><span class="sxs-lookup"><span data-stu-id="e2100-133">Keep this configuration page open in a separate browser tab as you'll be using it throughout the rest of this process.</span></span>

<span data-ttu-id="e2100-134">您可以在 Moodle 檔中找到如何安裝 [Moodle 外掛程式的更多資訊](https://docs.moodle.org/34/en/Installing_plugins)。</span><span class="sxs-lookup"><span data-stu-id="e2100-134">You can find more information on how to install Moodle plugins in the [Moodle documentation](https://docs.moodle.org/34/en/Installing_plugins).</span></span>

<span data-ttu-id="e2100-135">**重要注意事項：** 讓 Microsoft 365 或 Office 365 Moodle 外掛程式設定頁面在個別的瀏覽器索引鍵中保持開啟，因為您將在整個過程中回到這組頁面。</span><span class="sxs-lookup"><span data-stu-id="e2100-135">**Important Note:** Keep your Microsoft 365 or Office 365 Moodle Plugin configuration page open in a separate browser tab as you will be returning to this set of pages throughout this process.</span></span>

<span data-ttu-id="e2100-136">*還沒有 Moodle 網站？*</span><span class="sxs-lookup"><span data-stu-id="e2100-136">*Don't have a Moodle site already?*</span></span> <span data-ttu-id="e2100-137">您可能會想要查看 Azure 上的 [Moodle，](https://github.com/azure/moodle) 您可以在 Azure 上快速部署 Moodle 實例，並根據您的需求進行自訂。</span><span class="sxs-lookup"><span data-stu-id="e2100-137">You might want to check out our Moodle on Azure [repo](https://github.com/azure/moodle) where you can quickly deploy a Moodle instance on Azure and customize it to your needs.</span></span>

## <a name="step-2-configure-the-connection-between-the-microsoft-365-or-office-365-plugin-and-azure-active-directory"></a><span data-ttu-id="e2100-138">步驟 2：設定 Microsoft 365 或 Office 365 外掛程式與 Azure Active Directory 之間的連接</span><span class="sxs-lookup"><span data-stu-id="e2100-138">Step 2: Configure the connection between the Microsoft 365 or Office 365 plugin and Azure Active Directory</span></span>

> [!VIDEO https://www.youtube.com/embed/FpGEezaJ3SA]

<span data-ttu-id="e2100-139">接下來，您需要將 Moodle 註冊為 Azure Active Directory 中的應用程式。</span><span class="sxs-lookup"><span data-stu-id="e2100-139">Next you'll need to register Moodle as an application in your Azure Active Directory.</span></span> <span data-ttu-id="e2100-140">我們已提供 PowerShell 腳本，可協助您完成此程式。</span><span class="sxs-lookup"><span data-stu-id="e2100-140">We've provided a PowerShell script to help you complete this process.</span></span> <span data-ttu-id="e2100-141">PowerShell Script 會為 Microsoft 365 或 Office 365 組織提供新的 Azure AD 應用程式，由 Moodle 外掛程式使用。</span><span class="sxs-lookup"><span data-stu-id="e2100-141">The PowerShell Script provisions a new Azure AD application for your Microsoft 365 or Office 365 organization, which will be used by the Moodle Plugin.</span></span> <span data-ttu-id="e2100-142">腳本會針對您的 Microsoft 365 或 Office 365 租使用者設定應用程式、設定所設定應用程式的所有必要的回復 URL 和許可權，並退回 AppID 和 Key。</span><span class="sxs-lookup"><span data-stu-id="e2100-142">The script will provision the app for your Microsoft 365 or Office 365 tenant, set up all the required Reply URLs and Permissions for the provisioned app and return the AppID and Key.</span></span> <span data-ttu-id="e2100-143">您可以在 Moodle 外掛程式設定頁面中使用產生的 AppID 和 Key 來設定您的 Moodle 伺服器與 Azure AD。</span><span class="sxs-lookup"><span data-stu-id="e2100-143">You can use the generated AppID and Key in your Moodle Plugin Setup Page to configure your Moodle server with Azure AD.</span></span> <span data-ttu-id="e2100-144">如果您想要查看 PowerShell 腳本自動化的詳細手動步驟，您可以在外掛程式的完整檔中 [找到這些步驟](https://docs.moodle.org/34/en/Office365#Register_your_Moodle_instance_as_an_Application)。</span><span class="sxs-lookup"><span data-stu-id="e2100-144">If you want to see the detailed manual steps that the PowerShell script is automating, you can find them in the full [documentation for the plugin](https://docs.moodle.org/34/en/Office365#Register_your_Moodle_instance_as_an_Application).</span></span>

### <a name="moodle-tab-for-microsoft-teams-information-flow"></a><span data-ttu-id="e2100-145">Microsoft Teams 資訊流程的 Moodle Tab</span><span class="sxs-lookup"><span data-stu-id="e2100-145">Moodle tab for Microsoft Teams information flow</span></span>

<img width="530px" src="media/MoodleTabInformationFlow.png" alt="Illustration of Moodle tab for Microsoft Teams information flow" title="Microsoft Teams 資訊流程的 Moodle 定位停駐點圖例" />

1. <span data-ttu-id="e2100-147">從 Microsoft 365 或 Office 365 整合外掛程式頁面，選取設定 **選項卡** 。</span><span class="sxs-lookup"><span data-stu-id="e2100-147">From the Microsoft 365 or Office 365 Integration plugin page, select the **Setup** tab.</span></span>
1. <span data-ttu-id="e2100-148">按一下 [ **下載 PowerShell 腳本>** 按鈕，並將其儲存到您的本地電腦。</span><span class="sxs-lookup"><span data-stu-id="e2100-148">Click the **Download PowerShell Script** button and save it to your local computer.</span></span>
1. <span data-ttu-id="e2100-149">您必須從 ZIP 檔案準備 PowerShell 腳本。</span><span class="sxs-lookup"><span data-stu-id="e2100-149">You'll need to prepare the PowerShell script from the ZIP file.</span></span> <span data-ttu-id="e2100-150">若要這麼做：</span><span class="sxs-lookup"><span data-stu-id="e2100-150">To do so:</span></span>
    * <span data-ttu-id="e2100-151">下載並解壓縮 `Moodle-AzureAD-Powershell.zip` 檔案。</span><span class="sxs-lookup"><span data-stu-id="e2100-151">Download and extract the `Moodle-AzureAD-Powershell.zip` file.</span></span>
    * <span data-ttu-id="e2100-152">開啟解壓縮的資料夾。</span><span class="sxs-lookup"><span data-stu-id="e2100-152">Open the extracted folder.</span></span>
    * <span data-ttu-id="e2100-153">以滑鼠右鍵按一下 `Moodle-AzureAD-Script.ps1` 檔案，然後選取 [ **屬性**> 。</span><span class="sxs-lookup"><span data-stu-id="e2100-153">Right-click on the `Moodle-AzureAD-Script.ps1` file and select **Properties**.</span></span>
    * <span data-ttu-id="e2100-154">在屬性 **視窗** 的一般標籤下，勾選底部的 `Unblock` **安全性屬性** 旁的方塊。</span><span class="sxs-lookup"><span data-stu-id="e2100-154">Under the **General** tab of the Properties window, check the `Unblock` box next to the **Security** attribute at the bottom.</span></span>
    * <span data-ttu-id="e2100-155">按一下 [確定]。</span><span class="sxs-lookup"><span data-stu-id="e2100-155">Click **OK**.</span></span>
    * <span data-ttu-id="e2100-156">複製解壓縮資料夾的目錄路徑。</span><span class="sxs-lookup"><span data-stu-id="e2100-156">Copy the directory path of the extracted folder.</span></span>
1. <span data-ttu-id="e2100-157">接下來，您將以系統管理員的名次執行 PowerShell：</span><span class="sxs-lookup"><span data-stu-id="e2100-157">Next you'll run PowerShell as an administrator:</span></span>
    * <span data-ttu-id="e2100-158">按一下 [開始。</span><span class="sxs-lookup"><span data-stu-id="e2100-158">Click Start.</span></span>
    * <span data-ttu-id="e2100-159">輸入 PowerShell。</span><span class="sxs-lookup"><span data-stu-id="e2100-159">Type PowerShell.</span></span>
    * <span data-ttu-id="e2100-160">以滑鼠右鍵按一下 Windows PowerShell。</span><span class="sxs-lookup"><span data-stu-id="e2100-160">Right-click Windows PowerShell.</span></span>
    * <span data-ttu-id="e2100-161">按一下 [以系統管理員執行」。</span><span class="sxs-lookup"><span data-stu-id="e2100-161">Click "Run as Administrator".</span></span>
1. <span data-ttu-id="e2100-162">輸入目錄的路徑，以流覽至未解壓縮 `cd ...\...\Moodle-AzureAD-Powershell` `...\...` 的目錄。</span><span class="sxs-lookup"><span data-stu-id="e2100-162">Navigate to the unzipped directory by typing `cd ...\...\Moodle-AzureAD-Powershell` where `...\...` is the path to the directory.</span></span>
1. <span data-ttu-id="e2100-163">執行 PowerShell 腳本：：</span><span class="sxs-lookup"><span data-stu-id="e2100-163">Execute the PowerShell script by:</span></span>
    * <span data-ttu-id="e2100-164">輸入 `Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser` 。</span><span class="sxs-lookup"><span data-stu-id="e2100-164">Enter `Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser`.</span></span>
    * <span data-ttu-id="e2100-165">輸入 `.\Moodle-AzureAD-Script.ps1` 。</span><span class="sxs-lookup"><span data-stu-id="e2100-165">Enter `.\Moodle-AzureAD-Script.ps1`.</span></span>
    * <span data-ttu-id="e2100-166">在快顯視窗中登入您的 Microsoft 365 或 Office 365 系統管理員帳戶。</span><span class="sxs-lookup"><span data-stu-id="e2100-166">Log in to your Microsoft 365 or Office 365 Administrator account in the pop-up window.</span></span>
    * <span data-ttu-id="e2100-167">輸入 Azure AD 應用程式名稱 (Ex。</span><span class="sxs-lookup"><span data-stu-id="e2100-167">Enter the name of the Azure AD Application (Ex.</span></span> <span data-ttu-id="e2100-168">Moodle/Moodle 外掛程式) 。</span><span class="sxs-lookup"><span data-stu-id="e2100-168">Moodle/Moodle plugin).</span></span>
    * <span data-ttu-id="e2100-169">輸入您的 Moodle 伺服器的 URL。</span><span class="sxs-lookup"><span data-stu-id="e2100-169">Enter the URL of your Moodle server.</span></span>
    * <span data-ttu-id="e2100-170">複製 **腳本產生的\*\*\*\*應用程式** 識別碼和應用程式金鑰，然後儲存它們。</span><span class="sxs-lookup"><span data-stu-id="e2100-170">Copy the **Application ID** and **Application Key** generated by the script and save them.</span></span>
1. <span data-ttu-id="e2100-171">接下來，您需要在 Moodle 外掛程式中新增 Id 和 Key。</span><span class="sxs-lookup"><span data-stu-id="e2100-171">Next you'll need to add the Id and Key to the Moodle Plugin.</span></span> <span data-ttu-id="e2100-172">返回 Microsoft 365 整合 (管理>外掛程式>管理頁面) 。</span><span class="sxs-lookup"><span data-stu-id="e2100-172">Return to the plugin administration page (Site administration > Plugins > Microsoft 365 Integration).</span></span>
1. <span data-ttu-id="e2100-173">在 [**設定」** 選項卡上，新增您先前複製的應用程式 **識別碼** 和應用程式金鑰，然後按一下 [**儲存變更**。</span><span class="sxs-lookup"><span data-stu-id="e2100-173">On the **Setup** tab add the **Application Id** and **Application Key** you copied previously, then click **Save changes**.</span></span>
1. <span data-ttu-id="e2100-174">頁面重新建立之後，您應該會看到新的一節選擇 **連接方法**。</span><span class="sxs-lookup"><span data-stu-id="e2100-174">Once the page refreshes you should now see a new section **Choose connection method**.</span></span> <span data-ttu-id="e2100-175">按一下標示為 [預設值」 **的核取方塊** ，然後再按一下 **[儲存** 變更。</span><span class="sxs-lookup"><span data-stu-id="e2100-175">Click the checkbox labeled **Default** and then click **Save changes** again.</span></span>
1. <span data-ttu-id="e2100-176">頁面重新啟用之後，您就會看到另一個新節系統管理 **同意&其他資訊**。</span><span class="sxs-lookup"><span data-stu-id="e2100-176">Once the page refreshes you will see another new section **Admin consent & additional information**.</span></span>
    * <span data-ttu-id="e2100-177">按一下 [**提供系統管理員同意** 連結，輸入您的 Microsoft 365 或 Office 365全域系統管理員認證，然後接受以授予許可權。</span><span class="sxs-lookup"><span data-stu-id="e2100-177">Click the **Provide Admin Consent** link, enter your Microsoft 365 or Office 365 Global Administrator credentials, then **Accept** to grant the permissions.</span></span>
    * <span data-ttu-id="e2100-178">按一下 **Azure AD 租使用者欄位** 旁的 [ **偵測>** 按鈕。</span><span class="sxs-lookup"><span data-stu-id="e2100-178">Next to the **Azure AD Tenant** field click the **Detect** button.</span></span>
    * <span data-ttu-id="e2100-179">按一下 **商務用 OneDrive URL 旁** 的 [ **偵測>** 按鈕。</span><span class="sxs-lookup"><span data-stu-id="e2100-179">Next to the **OneDrive for Business URL** click the **Detect** button.</span></span>
    * <span data-ttu-id="e2100-180">欄位填入後，再次按一下 [ **儲存變更** > 按鈕。</span><span class="sxs-lookup"><span data-stu-id="e2100-180">Once the fields populate, click the **Save changes** button again.</span></span>
1. <span data-ttu-id="e2100-181">按一下 [ **更新>** 按鈕以驗證安裝，然後儲存 **變更**。</span><span class="sxs-lookup"><span data-stu-id="e2100-181">Click the **Update** button to verify the installation, then **Save changes**.</span></span>
1. <span data-ttu-id="e2100-182">接下來，您需要在 Moodle 伺服器和 Azure Active Directory 之間同步處理使用者。</span><span class="sxs-lookup"><span data-stu-id="e2100-182">Next you'll need to synchronize users between your Moodle server and Azure Active Directory.</span></span> <span data-ttu-id="e2100-183">視您的環境，您可以在此階段選取不同的選項。</span><span class="sxs-lookup"><span data-stu-id="e2100-183">Depending on your environment, you may select different options during this stage.</span></span> <span data-ttu-id="e2100-184">請注意，您在這裡設定的配置會隨著每一個 Moodle cron 執行 (一天執行一次) 讓所有專案保持同步。若要開始使用：</span><span class="sxs-lookup"><span data-stu-id="e2100-184">Note that the configuration you set here will run with each Moodle cron run (typically once a day) to keep everything in sync. To get started:</span></span>
    * <span data-ttu-id="e2100-185">切換到同步 **設定選項卡**</span><span class="sxs-lookup"><span data-stu-id="e2100-185">Switch to the **Sync Settings tab**</span></span>
    * <span data-ttu-id="e2100-186">在與 **Azure AD 同步** 處理使用者區段，選取適用于您環境的核取方塊。</span><span class="sxs-lookup"><span data-stu-id="e2100-186">In the **Sync users with Azure AD** section, select the checkboxes that apply to your environment.</span></span> <span data-ttu-id="e2100-187">一般來說，您至少會選取：</span><span class="sxs-lookup"><span data-stu-id="e2100-187">Typically you would select at least:</span></span>
        * <span data-ttu-id="e2100-188">在 Azure AD 中為使用者建立 Moodle 帳戶</span><span class="sxs-lookup"><span data-stu-id="e2100-188">Create accounts in Moodle for users in Azure AD</span></span>
        * <span data-ttu-id="e2100-189">在 Azure AD 中更新 Moodle 中使用者的所有帳戶</span><span class="sxs-lookup"><span data-stu-id="e2100-189">Update all accounts in Moodle for users in Azure AD</span></span>
    * <span data-ttu-id="e2100-190">在使用者 **建立限制** 區段，您可以設定篩選以限制要同步到 Moodle 的 Azure AD 使用者。</span><span class="sxs-lookup"><span data-stu-id="e2100-190">In the **User Creation Restriction** section you can set up a filter to limit the Azure AD users that will be synced to Moodle.</span></span>
    * <span data-ttu-id="e2100-191">使用者 **欄位映射** 區段將允許您自訂 Azure AD 到 Moodle 使用者設定檔欄位的映射。</span><span class="sxs-lookup"><span data-stu-id="e2100-191">The **User Field Mapping** section will allow you to customize the Azure AD to Moodle User Profile field mapping.</span></span>
    * <span data-ttu-id="e2100-192">在 Teams **同步處理** 區段，您可以選擇自動 (群組，) 或所有現有 Moodle 課程的 Teams 群組。</span><span class="sxs-lookup"><span data-stu-id="e2100-192">In the **Teams Sync** section you can choose to automatically create Groups (i.e. Teams) for some, or all, of your existing Moodle courses.</span></span>
1. <span data-ttu-id="e2100-193">若要驗證 cron 工作 (如果您想要第一次執行，請手動執行) 請按一下 [同步處理使用者與 Azure  **AD>** 區段的 [排定的工作管理頁面> 連結。</span><span class="sxs-lookup"><span data-stu-id="e2100-193">To validate the cron jobs (and run them manually if you wish to for the first run) click the **Scheduled tasks management page** link in the **Sync users with Azure AD** section.</span></span> <span data-ttu-id="e2100-194">這會將您帶至排 **程工作** 頁面。</span><span class="sxs-lookup"><span data-stu-id="e2100-194">This will take you to the **Scheduled Tasks** page.</span></span>
    * <span data-ttu-id="e2100-195">向下卷起並尋找將使用者與 **Azure AD 工作同步** 處理的工作，然後按一下 **[立即執行**> 。</span><span class="sxs-lookup"><span data-stu-id="e2100-195">Scroll down and find the job **Sync users with Azure AD** job and click **Run now**.</span></span>
    * <span data-ttu-id="e2100-196">如果您選擇根據現有的課程建立群組，您也可以在 **Office 365** 工作中執行建立使用者群組。</span><span class="sxs-lookup"><span data-stu-id="e2100-196">If you chose to create Groups based on existing courses, you can also run the **Create user groups in Office 365** job.</span></span>
1. <span data-ttu-id="e2100-197">返回 Microsoft 365 整合 (管理>外掛程式>管理頁面) 並選取 Teams **設定** 頁面。</span><span class="sxs-lookup"><span data-stu-id="e2100-197">Return to the plugin administration page (Site administration > Plugins > Microsoft 365 Integration) and select the **Teams Settings** page.</span></span> <span data-ttu-id="e2100-198">您需要設定一些安全性設定，才能啟用 Teams App 整合。</span><span class="sxs-lookup"><span data-stu-id="e2100-198">You'll need to configure some security settings to enable the Teams app integration.</span></span>
    * <span data-ttu-id="e2100-199">若要啟用 OpenID Connect，請按一下 [ **管理** 驗證> 連結，然後按一下 **OpenId Connect** 行上的眼睛圖示 ，如果顯示為灰色。</span><span class="sxs-lookup"><span data-stu-id="e2100-199">To enable OpenID Connect, click the **Manage Authentication** link, and click the eye icon on the **OpenId Connect** line if it is greyed out.</span></span>
    * <span data-ttu-id="e2100-200">接下來，您需要啟用框架內嵌。</span><span class="sxs-lookup"><span data-stu-id="e2100-200">Next you'll need to enable frame embedding.</span></span> <span data-ttu-id="e2100-201">按一下 **HTTP 安全性** 連結，然後按一下 [允許內嵌 **框架> 旁的核取方塊**。</span><span class="sxs-lookup"><span data-stu-id="e2100-201">Click the **HTTP Security** link, then click the checkbox next to **Allow frame embedding**.</span></span>
    * <span data-ttu-id="e2100-202">下一個步驟是啟用 Web 服務，以啟用 Moodle API 功能。</span><span class="sxs-lookup"><span data-stu-id="e2100-202">The next step is to enable web services which will enable the Moodle API features.</span></span> <span data-ttu-id="e2100-203">按一下 **[進一步功能** > 連結，然後確認已勾選 [ **啟用 Web 服務> 旁的** 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="e2100-203">Click the **Advanced Features** link, then make sure the checkbox next to **Enable web services** is checked.</span></span>
    * <span data-ttu-id="e2100-204">最後，您需要啟用 Microsoft 365 或 Office 365 的外部服務。</span><span class="sxs-lookup"><span data-stu-id="e2100-204">Finally you'll need to enable the external services for Microsoft 365 or Office 365.</span></span> <span data-ttu-id="e2100-205">接著 **，按一下 [外部服務** 連結：</span><span class="sxs-lookup"><span data-stu-id="e2100-205">Click the **External services** link then:</span></span>
        * <span data-ttu-id="e2100-206">在 **Moodle** **Office 365 Webservices** 列上按一下 [編輯。</span><span class="sxs-lookup"><span data-stu-id="e2100-206">Click **Edit** on the **Moodle Office 365 Webservices** row.</span></span>
        * <span data-ttu-id="e2100-207">標記 [已啟用的 **核取方塊，** 然後按一下 [ **儲存變更**</span><span class="sxs-lookup"><span data-stu-id="e2100-207">Mark the checkbox next to **Enabled**, then click **Save Changes**</span></span>
    * <span data-ttu-id="e2100-208">接下來，您需要編輯已驗證的使用者許可權，讓他們建立 Web 服務權杖。</span><span class="sxs-lookup"><span data-stu-id="e2100-208">Next you'll need to edit your authenticated user permissions to allow them to create web service tokens.</span></span> <span data-ttu-id="e2100-209">按一下 **[編輯角色'已驗證的使用者'連結** 。</span><span class="sxs-lookup"><span data-stu-id="e2100-209">Click the **Editing role 'Authenticated user'** link.</span></span> <span data-ttu-id="e2100-210">向下卷起並尋找 **建立 Web 服務權杖** 功能，並 **標記允許核取方塊** 。</span><span class="sxs-lookup"><span data-stu-id="e2100-210">Scroll down and find the **Create a web service token** capability and mark the **Allow** checkbox.</span></span>

## <a name="step-3-deploy-the-moodle-assistant-bot-to-azure"></a><span data-ttu-id="e2100-211">步驟 3：將 Moodle 小幫手 Bot 部署到 Azure</span><span class="sxs-lookup"><span data-stu-id="e2100-211">Step 3: Deploy the Moodle Assistant Bot to Azure</span></span>

> [!VIDEO https://www.youtube.com/embed/gbkJxf8FlfY]

<span data-ttu-id="e2100-212">Microsoft Teams 的免費 Moodle 小幫手 Bot 可協助教師和學生回答在 Moodle 中課程、作業、成績和其他資訊的問題。</span><span class="sxs-lookup"><span data-stu-id="e2100-212">The free Moodle Assistant Bot for Microsoft Teams helps teachers and students answer questions about their courses, assignments, grades and other information in Moodle.</span></span> <span data-ttu-id="e2100-213">Bot 也會在 Teams 中傳送 Moodle 通知給學生和教師。</span><span class="sxs-lookup"><span data-stu-id="e2100-213">The bot also sends Moodle notifications to students and teachers right within Teams.</span></span> <span data-ttu-id="e2100-214">此 Bot 是由 Microsoft 維護的開放原始碼專案，可在 [GitHub 上使用](https://github.com/microsoft/Moodle-Teams-Bot)。</span><span class="sxs-lookup"><span data-stu-id="e2100-214">This bot is an open source project maintained by Microsoft, and is [available on GitHub](https://github.com/microsoft/Moodle-Teams-Bot).</span></span>

> [!NOTE]
> <span data-ttu-id="e2100-215">在此區段，您將部署資源至 Azure 訂閱，而所有資源都會使用免費 **層級** 進行配置。</span><span class="sxs-lookup"><span data-stu-id="e2100-215">In this section you will deploy resources to your Azure subscription, and all resources will be configured using the **free** tier.</span></span> <span data-ttu-id="e2100-216">視您 Bot 的使用量，您可能需要縮放這些資源。</span><span class="sxs-lookup"><span data-stu-id="e2100-216">Depending on the usage of your bot, you may need to scale these resources.</span></span>
> <span data-ttu-id="e2100-217">如果您想要直接使用沒有 Bot 的 Moodle 定位停駐點，請跳至[步驟 4。](#step-4-deploy-your-microsoft-teams-app)</span><span class="sxs-lookup"><span data-stu-id="e2100-217">If you want to just use the Moodle tab without the bot, skip to [step 4](#step-4-deploy-your-microsoft-teams-app).</span></span>

### <a name="moodle-bot-information-flow"></a><span data-ttu-id="e2100-218">Moodle Bot 資訊流程</span><span class="sxs-lookup"><span data-stu-id="e2100-218">Moodle bot information flow</span></span>

<img width="530px" src="media/MoodleBotInformationFlow.png" alt="llustration of Moodle bot for Microsoft Teams information flow" title="Microsoft Teams 資訊流程的 Moodle Bot 圖例" />


<span data-ttu-id="e2100-220">若要安裝 Bot，您首先需要在 [Microsoft 身分](https://identity.microsoft.com/Landing)識別平臺上註冊。</span><span class="sxs-lookup"><span data-stu-id="e2100-220">To install the bot, you'll first need to register it on the [Microsoft Identity Platform](https://identity.microsoft.com/Landing).</span></span> <span data-ttu-id="e2100-221">這可讓您的 Bot 針對您的 Microsoft 端點進行驗證。</span><span class="sxs-lookup"><span data-stu-id="e2100-221">This allows your Bot to authenticate against your Microsoft endpoints.</span></span> <span data-ttu-id="e2100-222">若要註冊您的 Bot：</span><span class="sxs-lookup"><span data-stu-id="e2100-222">To register your bot:</span></span>

1. <span data-ttu-id="e2100-223">返回 Microsoft 365 整合 (網站管理>外掛程式>管理頁面) 並選取 Teams **設定** 選項卡。</span><span class="sxs-lookup"><span data-stu-id="e2100-223">Return to the plugin administration page (Site administration > Plugins > Microsoft 365 Integration) and select the **Teams Settings** tab.</span></span>
1. <span data-ttu-id="e2100-224">按一下 **Microsoft 應用程式註冊入口網站** 連結，然後使用 Microsoft Id 登入。</span><span class="sxs-lookup"><span data-stu-id="e2100-224">Click the **Microsoft Application Registration Portal** link and login with your Microsoft Id.</span></span>
1. <span data-ttu-id="e2100-225">輸入應用程式的名稱，例如 (名稱。</span><span class="sxs-lookup"><span data-stu-id="e2100-225">Enter a name for your app (Eg.</span></span> <span data-ttu-id="e2100-226">MoodleBot) 並按一下 [ **建立>** 按鈕。</span><span class="sxs-lookup"><span data-stu-id="e2100-226">MoodleBot) and click the **Create** button.</span></span>
1. <span data-ttu-id="e2100-227">複製 **應用程式識別碼，** 然後將其貼到小組設定頁面上的 **Bot 應用程式識別碼** 欄位。 </span><span class="sxs-lookup"><span data-stu-id="e2100-227">Copy the **Application Id** and paste it into the **Bot Application ID** field on the **Team Settings** page.</span></span>
1. <span data-ttu-id="e2100-228">按一下 [ **產生新密碼>** 按鈕。</span><span class="sxs-lookup"><span data-stu-id="e2100-228">Click the **Generate New Password** button.</span></span> <span data-ttu-id="e2100-229">複製產生的密碼，並貼到小組設定頁面上的 **Bot** 應用程式 **密碼** 欄位。</span><span class="sxs-lookup"><span data-stu-id="e2100-229">Copy the generated password and paste it into the **Bot Application Password** field on the **Team Settings** page.</span></span>
1. <span data-ttu-id="e2100-230">卷起至表單底部，然後按一下 [ **儲存變更**。</span><span class="sxs-lookup"><span data-stu-id="e2100-230">Scroll to the bottom of the form and click **Save Changes**.</span></span>

<span data-ttu-id="e2100-231">現在，您產生了應用程式識別碼和密碼，是時候將 Bot 部署到 Azure 了。</span><span class="sxs-lookup"><span data-stu-id="e2100-231">Now that you've generated your Application Id and Password, it's time to deploy your bot to Azure.</span></span> <span data-ttu-id="e2100-232">按一下 [部署至 **Azure>** 按鈕，然後填寫表單 ([Bot 應用程式識別碼、Bot 應用程式密碼和 Moodle 機密」 位於[小組設定> 頁面上，而 Azure資訊位於 [設定) > 頁面上。</span><span class="sxs-lookup"><span data-stu-id="e2100-232">Click on the **Deploy to Azure** button and fill out the form with the necessary information (the Bot Application Id, Bot Application Password and the Moodle Secret are on the **Team Settings** page, and the Azure information is on the **Setup** page).</span></span> <span data-ttu-id="e2100-233">填寫好表單之後，請按一下核取方塊以同意條款與條件，然後按一下 [購買 (所有 Azure 資源都部署到免費層級) 。</span><span class="sxs-lookup"><span data-stu-id="e2100-233">Once you've got the form filled out, click the check box to agree to the terms and conditions then click the **Purchase** button (all Azure resources are deployed to the free tier).</span></span>

<span data-ttu-id="e2100-234">資源部署到 Azure 後，您必須設定具有其訊息端點的 Moodle 外掛程式。</span><span class="sxs-lookup"><span data-stu-id="e2100-234">Once the resources are finished deploying to Azure, you'll need to configure the Moodle plugin with its messaging endpoint.</span></span> <span data-ttu-id="e2100-235">首先，您必須從 Azure 中的 Bot 取得端點。</span><span class="sxs-lookup"><span data-stu-id="e2100-235">First, you'll need to get the endpoint from your Bot in Azure.</span></span> <span data-ttu-id="e2100-236">若要這麼做：</span><span class="sxs-lookup"><span data-stu-id="e2100-236">To do that:</span></span>

1. <span data-ttu-id="e2100-237">如果您還沒有，請登入 [Azure 入口網站](https://portal.azure.com)。</span><span class="sxs-lookup"><span data-stu-id="e2100-237">If you aren't already, log into the [Azure portal](https://portal.azure.com).</span></span>
2. <span data-ttu-id="e2100-238">在左窗格中選取 **資源群組**。</span><span class="sxs-lookup"><span data-stu-id="e2100-238">In the left pane select **Resource groups**.</span></span>
3. <span data-ttu-id="e2100-239">從清單中選取您部署 Bot 時 (或) 建立的資源群組。</span><span class="sxs-lookup"><span data-stu-id="e2100-239">From the list select the resource group you just used (or created) while deploying your Bot.</span></span>
4. <span data-ttu-id="e2100-240">從群組中的資源清單中選取 **WebApp** Bot 資源。</span><span class="sxs-lookup"><span data-stu-id="e2100-240">Select the **WebApp Bot** resource from the list of resources in the group.</span></span>
5. <span data-ttu-id="e2100-241">從 **概觀區段** 複製訊息 **端點** 。</span><span class="sxs-lookup"><span data-stu-id="e2100-241">Copy the **Messaging Endpoint** from the **Overview** section.</span></span>
6. <span data-ttu-id="e2100-242">在 Moodle 中，開啟您 Moodle **外掛程式** 的小組設定頁面。</span><span class="sxs-lookup"><span data-stu-id="e2100-242">In Moodle, open the **Team Settings** page of your Moodle Plugin.</span></span>
7. <span data-ttu-id="e2100-243">在 **Bot 端點欄位中** 貼上您剛才複製的 URL，然後將郵件 *一* 詞變更為 *web上。*</span><span class="sxs-lookup"><span data-stu-id="e2100-243">In the **Bot Endpoint** field paste the URL you just copied and change the word *messages* to *webhook*.</span></span> <span data-ttu-id="e2100-244">URL 現在應該看起來像 `https://botname.azurewebsites.net/api/webhook`</span><span class="sxs-lookup"><span data-stu-id="e2100-244">The URL should now look like `https://botname.azurewebsites.net/api/webhook`</span></span>
8. <span data-ttu-id="e2100-245">按一下 **[儲存變更**</span><span class="sxs-lookup"><span data-stu-id="e2100-245">Click **Save Changes**</span></span>
9. <span data-ttu-id="e2100-246">儲存變更之後，請回到 [小組設定> 選項卡，按一下[下載清單檔案> 按鈕，將清單套件儲存到您的電腦 (您將在) 的下一節中使用它。</span><span class="sxs-lookup"><span data-stu-id="e2100-246">Once your changes have saved, go back to the **Team Settings** tab, click the **Download manifest file** button and save the manifest package to your computer (you'll use it in the next section).</span></span>

## <a name="step-4-deploy-your-microsoft-teams-app"></a><span data-ttu-id="e2100-247">步驟 4：部署您的 Microsoft Teams 應用程式</span><span class="sxs-lookup"><span data-stu-id="e2100-247">Step 4: Deploy your Microsoft Teams app</span></span>

> [!VIDEO https://www.youtube.com/embed/2rMb7gtM_ZM]

<span data-ttu-id="e2100-248">現在，您的 Bot 已部署至 Azure，且已配置為與 Moodle 伺服器交談，現在該是部署 Microsoft Teams 應用程式的時候。</span><span class="sxs-lookup"><span data-stu-id="e2100-248">Now that you have your Bot deployed to Azure and configured to talk to your Moodle server, it's time to deploy your Microsoft Teams app.</span></span> <span data-ttu-id="e2100-249">若要這麼做，您將在上一個步驟的 Moodle 外掛程式小組設定頁面載入您下載的清單檔案。</span><span class="sxs-lookup"><span data-stu-id="e2100-249">To do this you'll load the manifest file you downloaded from the Moodle Plugin Team Settings page in the previous step.</span></span>

<span data-ttu-id="e2100-250">安裝應用程式之前，您必須確認已啟用外部 App 和側載應用程式。</span><span class="sxs-lookup"><span data-stu-id="e2100-250">Before you can install the app you'll need to make sure external apps and sideloading of apps is enabled.</span></span> <span data-ttu-id="e2100-251">若要這麼做，您可以遵循[下列步驟。](./admin-settings.md)</span><span class="sxs-lookup"><span data-stu-id="e2100-251">To do so you can follow [these steps](./admin-settings.md).</span></span> <span data-ttu-id="e2100-252">一旦確定已啟用外部應用程式後，您可以遵循下列步驟來部署應用程式。</span><span class="sxs-lookup"><span data-stu-id="e2100-252">Once you've ensured that external apps are enabled, you can follow the steps below to deploy your app.</span></span>

1. <span data-ttu-id="e2100-253">開啟 Microsoft Teams。</span><span class="sxs-lookup"><span data-stu-id="e2100-253">Open Microsoft Teams.</span></span>
2. <span data-ttu-id="e2100-254">按一下 **流覽** 欄左下角的 [市集」 圖示。</span><span class="sxs-lookup"><span data-stu-id="e2100-254">Click the **Store** icon on the lower left of the navigation bar.</span></span>
3. <span data-ttu-id="e2100-255">按一下 **選項清單中的 [** 上傳自訂應用程式連結。</span><span class="sxs-lookup"><span data-stu-id="e2100-255">Click the **Upload a custom app** link from the list of options.</span></span> <span data-ttu-id="e2100-256">*注意：* 如果您是以全域管理員登入，您可以選擇將應用程式上傳到組織的 App Store，否則您只能載入您屬於 (「側載」) 之 Teams 的應用程式。</span><span class="sxs-lookup"><span data-stu-id="e2100-256">*Note:* If you're logged in as a global administer you'll have the option of uploading the app to your organization's app store, otherwise you'll only be able to load the app for Teams you're a part of ("sideloading").</span></span>
4. <span data-ttu-id="e2100-257">選取 `manifest.zip` 您先前下載的套件，然後按一下 [ **儲存**。</span><span class="sxs-lookup"><span data-stu-id="e2100-257">Select the `manifest.zip` package you downloaded previously and click **Save**.</span></span> <span data-ttu-id="e2100-258">如果您尚未下載清單套件，可以從 Moodle 中外掛程式設定頁面的小組設定選項卡執行此操作。</span><span class="sxs-lookup"><span data-stu-id="e2100-258">If you haven't yet downloaded the manifest package, you can do so from the **Team Settings** tab of the plugin configuration page in Moodle.</span></span>

<span data-ttu-id="e2100-259">現在您已安裝應用程式，您可以將該定位停駐點新到任何您能夠存取的頻道。</span><span class="sxs-lookup"><span data-stu-id="e2100-259">Now that you have the app installed you can add the tab to any channel that you have access to.</span></span> <span data-ttu-id="e2100-260">若要這麼做，請流覽至頻道，按一下 **+** 符號，然後從清單中選取您的應用程式。</span><span class="sxs-lookup"><span data-stu-id="e2100-260">To do so navigate to the channel, click the **+** symbol and select your app from the list.</span></span> <span data-ttu-id="e2100-261">請遵循提示完成將 Moodle 課程定位停駐點新增到頻道。</span><span class="sxs-lookup"><span data-stu-id="e2100-261">Follow the prompts to finish adding your Moodle course tab to a channel.</span></span>

<span data-ttu-id="e2100-262">就是這樣！</span><span class="sxs-lookup"><span data-stu-id="e2100-262">That's it!</span></span> <span data-ttu-id="e2100-263">您和您的團隊現在可以直接從 Microsoft Teams 開始處理您的 Moodle 課程。</span><span class="sxs-lookup"><span data-stu-id="e2100-263">You and your team, can now start working with your Moodle courses directly from Microsoft Teams.</span></span>

<span data-ttu-id="e2100-264">若要與我們分享任何功能要求或意見，請流覽我們的 [使用者語音頁面](https://microsoftteams.uservoice.com/forums/916759-moodle)。</span><span class="sxs-lookup"><span data-stu-id="e2100-264">To share any feature requests or feedback with us, please visit our [User Voice page](https://microsoftteams.uservoice.com/forums/916759-moodle).</span></span>

[!INCLUDE [uservoice-disclaimer-note](includes/uservoice-disclaimer-note.md)]